<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.2.0
Version: 3.4
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest (the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->

<!-- Head BEGIN -->
<head>
  <meta charset="utf-8">
  <title>CS LIQUIDATION</title>

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <meta content="Metronic Shop UI description" name="description">
  <meta content="Metronic Shop UI keywords" name="keywords">
  <meta content="keenthemes" name="author">

  <meta property="og:site_name" content="-CUSTOMER VALUE-">
  <meta property="og:title" content="-CUSTOMER VALUE-">
  <meta property="og:description" content="-CUSTOMER VALUE-">
  <meta property="og:type" content="website">
  <meta property="og:image" content="-CUSTOMER VALUE-"><!-- link to image for socio -->
  <meta property="og:url" content="-CUSTOMER VALUE-">

  <link rel="shortcut icon" href="favicon.ico">

  <!-- Fonts START -->
  <link href="<?php echo base_url();?>assets/admin.css" rel="stylesheet" type="text/css">
  <!-- Fonts END -->

  <!-- Global styles START -->          
  <link href="<?php echo base_url();?>assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="<?php echo base_url();?>assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- Global styles END --> 
   
  <!-- Page level plugin styles START -->
  <link href="<?php echo base_url();?>assets/global/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet">
  <!-- Page level plugin styles END -->

  <!-- BEGIN PAGE LEVEL STYLES -->
  <link rel="stylesheet" type="text/css" href="<?php echo base_url()?>assets/global/plugins/select2/select2.css">
  <link rel="stylesheet" type="text/css" href="<?php echo base_url()?>assets/global/plugins/datatables/extensions/Scroller/css/dataTables.scroller.min.css">
  <link rel="stylesheet" type="text/css" href="<?php echo base_url()?>assets/global/plugins/datatables/extensions/ColReorder/css/dataTables.colReorder.min.css">
  <link rel="stylesheet" type="text/css" href="<?php echo base_url()?>assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css">
  <!-- END PAGE LEVEL STYLES -->

  <!-- Theme styles START -->
  <link href="<?php echo base_url();?>assets/global/css/components.css" rel="stylesheet">
  <link href="<?php echo base_url();?>assets/frontend/layout/css/style.css" rel="stylesheet">
  <link href="<?php echo base_url();?>assets/frontend/pages/css/portfolio.css" rel="stylesheet">
  <link href="<?php echo base_url();?>assets/frontend/layout/css/style-responsive.css" rel="stylesheet">
  <link href="<?php echo base_url();?>assets/frontend/layout/css/themes/red.css" rel="stylesheet" id="style-color">
  <link href="<?php echo base_url();?>assets/frontend/layout/css/custom.css" rel="stylesheet">
  <!-- Theme styles END -->

  <link href="<?php echo base_url();?>assets/global/css/components-md.css" id="style_components" rel="stylesheet" type="text/css">
  <link href="<?php echo base_url();?>assets/global/css/plugins-md.css" rel="stylesheet" type="text/css">
  <link href="<?php echo base_url();?>assets/admin/layout3/css/layout.css" rel="stylesheet" type="text/css">
  <link href="<?php echo base_url();?>assets/admin/layout3/css/themes/default.css" rel="stylesheet" type="text/css" id="style_color">
  <link href="<?php echo base_url();?>assets/admin/layout3/css/custom.css" rel="stylesheet" type="text/css">
  <link href="<?php echo base_url();?>assets/css/jquery-ui.css" rel="stylesheet">


<style type="text/css">
table.dataTable td.dataTables_empty 
{
  text-align: center;    
}

.wrapper {
    overflow: auto;
    height: 500px;
    /*width: 50%;*/

    /*border: 1px solid red;*/
}
.content 
{
    overflow-y: auto;
}


table.display tbody tr:nth-child(even):hover td
{
background-color: #ff5722; !important;
color: black;
}

  table.display tbody tr:nth-child(even):hover td
  {
  background-color: #ff5722 !important;
  color: black;
  }

  table.display tbody tr:nth-child(odd):hover td 
  {
  background-color: #ff5722 !important;
  color: black;
  }

  table.display tbody tr:nth-child(even):hover td .spn
  {
  background-color: #ff5722 !important;
  color: black;
  }

  table.display tbody tr:nth-child(odd):hover td .spn
  {
  background-color: #ff5722 !important;
  color: black;
  }


  input
{
  display: none;
}

label input[type=checkbox] ~ span 
{
  display: inline-block;
  vertical-align: middle;
  cursor: pointer;
  background: #fff;
  border: 1px solid #888;
  padding: 1px;
  height: 20px;
  width: 20px;
}

label input[type=checkbox]:checked ~ span 
{ 
  background: url('<?php echo base_url();?>image/check.png');
  background-size: 100%;
}
</style>
</head>
<!-- Head END -->

<!-- Body BEGIN -->
<body class="corporate">
    <!-- BEGIN STYLE CUSTOMIZER -->
    
    <!-- END BEGIN STYLE CUSTOMIZER --> 

    <?php
      $this->load->view('header');
    ?>

        <div class="page-container">

  <!-- END PAGE HEAD -->
  <!-- BEGIN PAGE CONTENT -->
  <div class="page-content" style="background: #ffffff;">
    <div class="container">
      <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->
     
      <!-- /.modal -->
      <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->
      <!-- BEGIN PAGE BREADCRUMB -->

      <!-- END PAGE BREADCRUMB -->
      <!-- BEGIN PAGE CONTENT INNER -->
      <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->
     
      <!-- /.modal -->
      <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->
      <!-- BEGIN PAGE BREADCRUMB -->

      <!-- END PAGE BREADCRUMB -->
      <!-- BEGIN PAGE CONTENT INNER -->
      <div class="row">
        <div class="col-md-12">
        <!-- BEGIN SAMPLE FORM PORTLET-->
       <div class="portlet light">
            <div class="portlet-title" style="background: #cecece;">
                <div class="portlet-body form">
                    <form class="form-horizontal" role="form">
                        <div class="form-body">
                                        
                                <div class="form-group col-md-4" style="background:;">
                                    <label class="col-md-5 control-label" style="padding-top: 0px;">Deduction Date :</label>
                                    <div class="col-md-7">
                                        <select class="form-control input-sm" id="deduction_date" name="deduction_date">
                                           <?php
                                                foreach ($deduction_date_data as $key => $value) 
                                                {
                                                    ?>
                                                        <!-- <option>03-04-2019</option> -->
                                                        <option><?php echo date('m-d-Y', strtotime($value['cut_off_date']))?></option>
                                                        <!-- <option>03-31-2019</option> -->
                                                    <?php
                                                }
                                           ?>
                                        </select>
                                    </div>
                                </div>
                            
                            <button type="button" class="btn green btn-sm" id="submit_deduction_btn">SUBMIT DEDUCTION</button>
                        </div>
                    </form>
                </div>             
            </div>
            <br/>
            <div class="portlet-body">
                <form id="denomination_form">
                    <table class="table table-bordered table-hover table-condensed display" id="deduction_table">
                        <thead>
                            <tr>  
                              <th style="width: 1px;"> <label class="checker"> <center><input type='checkbox' class='select_all' id="select_all"/><span></span></center></label></th>                                                        
                              <th>
                                 <center>EMPLOYEE NAME</center>
                              </th>
                               <th>
                                 <center>DEPARTMENT</center>
                              </th>
                              <th>
                                 <center>AMOUNT</center>
                              </th>
                              <th>
                                 <center>DEDUCTION DATE</center>
                              </th>
                              <th>
                                 <center>DETAILS</center>
                              </th>
                            </tr>
                        </thead>
                    </table>
                </form>            
            </div>                        
          </div> 

        </div>  
      </div>    
      <!-- END PAGE CONTENT INNER -->
    </div>
  </div>
  <!-- END PAGE CONTENT -->
</div>



    <!-- Load javascripts at bottom, this will reduce page load time -->
    <!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
    <!--[if lt IE 9]>
    <script src="<?php echo base_url();?>assets/global/plugins/respond.min.js"></script>
    <![endif]--> 
    <script src="<?php echo base_url();?>assets/global/plugins/jquery.min.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/src/jquery.maskMoney.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/plugins/jquery-migrate.min.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>      
    <script src="<?php echo base_url();?>assets/frontend/layout/scripts/back-to-top.js" type="text/javascript"></script>

    <script src="<?php echo base_url();?>assets/global/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
    <!-- <script src="<?php echo base_url();?>assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script> -->
    <script src="<?php echo base_url();?>assets/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
    <!-- END CORE PLUGINS -->

    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/datatables/media/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/datatables/extensions/TableTools/js/dataTables.tableTools.min.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/datatables/extensions/ColReorder/js/dataTables.colReorder.min.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/datatables/extensions/Scroller/js/dataTables.scroller.min.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js"></script>


<!-- END PAGE LEVEL PLUGINS -->

    <!-- BEGIN PAGE LEVEL JAVASCRIPTS (REQUIRED ONLY FOR CURRENT PAGE) -->
    <script src="<?php echo base_url();?>assets/global/plugins/fancybox/source/jquery.fancybox.pack.js" type="text/javascript"></script><!-- pop up -->
    <script src="<?php echo base_url();?>assets/global/plugins/jquery-mixitup/jquery.mixitup.min.js" type="text/javascript"></script>
    
    <script src="<?php echo base_url();?>assets/frontend/layout/scripts/layout.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/global/scripts/metronic.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/frontend/pages/scripts/portfolio.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>assets/admin/layout3/scripts/demo.js" type="text/javascript"></script>
    <script src="<?php echo base_url();?>js/datepicker/daterangepicker.js"></script>
    <script src="<?php echo base_url();?>assets/admin/pages/scripts/components-pickers.js"></script>


<!-- END PAGE LEVEL PLUGINS -->


    <script type="text/javascript">
        jQuery(document).ready(function() {
            Layout.init();
            Layout.initTwitter();
            Portfolio.init();
            ComponentsPickers.init();
        });
    </script>
    <!-- END PAGE LEVEL JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>


<div class="modal fade" id="delete_modal" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Delete</h4>
            </div>
            <div class="modal-body">
                You are about to delete denomination data! Do you really want to continue?
            </div>
            <div class="modal-footer">
            <button type="button" id="btn_delete" class="btn btn-sm btn-success">Save changes</button>
            <button type="button" class="btn default btn-sm" data-dismiss="modal">Close</button>
            </div>
        </div>
    <!-- /.modal-content -->
    </div>
<!-- /.modal-dialog -->
</div>


<div class="modal fade" id="breakdown_modal" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Deduction Details Dialog</h4>
            </div>
            <div class="modal-body">
                <table class="table table-bordered table-responsive table-striped table-hover display" id="breakdown_table">
                <thead>
                <tr>
                    <th><center>DATE</center></th>
                    <th><center>AMOUNT</center></th>                                                                                                                              
                </tr>
                </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn default" data-dismiss="modal"><span class="md-click-circle md-click-animate" style="height: 65px; width: 65px; top: -14.5px; left: 1.51563px;"></span>Close</button>
                
            </div>
        </div>
    <!-- /.modal-content -->
    </div>
<!-- /.modal-dialog -->
</div>


<div class="modal fade" id="no_checkbox_selected" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Error Dialog</h4>
            </div>
            <div class="modal-body">
                No data selected.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn default" data-dismiss="modal"><span class="md-click-circle md-click-animate" style="height: 65px; width: 65px; top: -14.5px; left: 1.51563px;"></span>Close</button>
                
            </div>
        </div>
    <!-- /.modal-content -->
    </div>
<!-- /.modal-dialog -->
</div>

<div class="modal fade" id="submit_deduction_modal" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Confirmation Dialog</h4>
            </div>
            <div class="modal-body">
                You are about to submit employees deduction. Do you want to continue?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn default" data-dismiss="modal"><span class="md-click-circle md-click-animate" style="height: 65px; width: 65px; top: -14.5px; left: 1.51563px;"></span>Close</button>
                <button type="button" class="btn btn-success" id="submit_deduction_con_btn">Continue</button>
            </div>
        </div>
    <!-- /.modal-content -->
    </div>
<!-- /.modal-dialog -->
</div>

<div class="modal fade" id="success_modal" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Success Dialog</h4>
            </div>
            <div class="modal-body">
                Employee deduction successfully submitted.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn default" data-dismiss="modal"><span class="md-click-circle md-click-animate" style="height: 65px; width: 65px; top: -14.5px; left: 1.51563px;"></span>Close</button>
                
            </div>
        </div>
    <!-- /.modal-content -->
    </div>
<!-- /.modal-dialog -->
</div>




<script type="text/javascript">

// $('#submit_deduction_btn').prop('disabled', true);

var deduction_table; 
var link1 = '<?php echo $this->security->get_csrf_token_name();?>';
var link2 = '<?php echo $this->security->get_csrf_hash();?>';
var equals = '=';
var url = '<?php echo site_url('main_controller/deduction_table_con');?>';

$("#deduction").addClass("active");      
deduction_table =  $('#deduction_table').DataTable(
{
    "ordering": false,
    "ajax": {
    "url": url,
    "type": "POST",
    "data":function(data) {
    data.deduction_date = $('#deduction_date').val();                                      
    data.link1+ equals +link2;        
    },
    },
        "columnDefs": [
            { className: "text-right", "targets": [3] } ,
            { className: "text-center", "targets": [4,5] },
        ],           
}).page.len(100).draw();

$("#deduction_date").change(function()
{
    var deduction_date = document.getElementById("deduction_date").value;

    if(deduction_date == 'Please select date')
    {
        $('#deduction_date_modal').modal('show');
    }
    else
    {  
        deduction_table.ajax.reload(null, false);                   

    }
});

function details(emp_id, deduction_date)
{
    $.ajax({
        url: '<?php echo site_url('main_controller/details_con')?>',
        type:'post',
        data:{emp_id:emp_id, deduction_date:deduction_date},
        success:function(data)
        {
            var data  = $.parseJSON(data); 
            table = $('#breakdown_table').DataTable({destroy:true,data:data.data,
                      "dom": 'ltir',
                       "columnDefs":[                      
                                      { className: "text-right", "targets": [1] },
                                      { className: "text-center", "targets": [0] }                               
                                    ],
                      "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]                               
                      });

            table.page.len(1000).draw();
                        
            $('#breakdown_modal').modal('show');
        }
    });
}

var select_all = document.getElementById("select_all"); //select all checkbox
var checkboxes = document.getElementsByClassName("check_box"); //checkbox items

 $('#select_all').click(function () {
       deduction_table.page.len(1000).draw();

select_all.addEventListener("change", function(e)
{
    for (i = 0; i < checkboxes.length; i++) 
    { 
        checkboxes[i].checked = select_all.checked;
    }   
});

})


 $("#submit_deduction_btn").click(function(event){

    if ($("#check_box:checked").length == 0)
    {
        $('#no_checkbox_selected').modal('show');
    }
    else
    {
      var deduction_date = document.getElementById("deduction_date").value;

      $('#submit_deduction_modal').modal('show'); 
      
      $("#submit_deduction_con_btn").unbind('click').bind('click', function()       
      { 
        $('#submit_deduction_con_btn').prop('disabled', true);
        var check = $("input[class='check_box']:checked").map(function() {
        return this.value;
        }).get();

        $.ajax(
        {
            url:'<?php echo site_url('main_controller/submit_ded_con');?>',
            type:'POST',
            data: {check:check, deduction_date:deduction_date},
            success:function(data)
            {   
                $('#submit_deduction_modal').modal('hide');
                $('#success_modal').modal('show');
                $('#submit_deduction_con_btn').prop('disabled', false);
                $('#select_all').attr('checked', false);

                $("#deduction_date option:selected").remove();
                deduction_table.ajax.reload(null, false);  
                // $('#deduction_date').val('');
            }
        });
      });        
    }
});

</script>









